{"version":3,"sources":["system.js"],"names":["doTapClickHandler","evt","type","targetTouches","length","target","nodeName","toLowerCase","nodeType","document","classList","contains","parentNode","isMove","startT","Date","now","identy","identifier","startX","clientX","startY","clientY","addEventListener","activeElement","blur","distX","changedTouches","distY","threshold","preventDefault","removeEventListener","holdDelay","touch","event","createEvent","initMouseEvent","view","detail","screenX","screenY","dispatchEvent","documentElement"],"mappings":"AAkDA,QAAAA,mBAAAC,GACA,GAAA,cAAAA,EAAAC,KAAA,CACA,GAAAD,EAAAE,cAAAC,QAAA,EACA,MAGA,IAAAC,GAAAJ,EAAAI,OACAC,EAAAD,EAAAC,SAAAC,cACAC,EAAAH,EAAAG,QAEA,IAAA,GAAAA,IAAA,SAAAF,GAAA,YAAAA,GAEA,MAGA,MAAAD,GAAAA,GAAAI,UAAA,CACA,GAAAJ,EAAAK,UAAAC,SAAA,cAEA,MAGAN,GAAAA,EAAAO,WAmBA,MAhBAC,SAAA,EACAC,OAAAC,KAAAC,MACAC,OAAAhB,EAAAE,cAAA,GAAAe,WACAC,OAAAlB,EAAAE,cAAA,GAAAiB,QACAC,OAAApB,EAAAE,cAAA,GAAAmB,QAEAb,SAAAc,iBAAA,YAAAvB,mBAAA,GACAS,SAAAc,iBAAA,WAAAvB,mBAAA,GACAS,SAAAc,iBAAA,cAAAvB,mBAAA,QAKAS,SAAAe,eACAf,SAAAe,cAAAC,QAKA,GAAA,aAAAxB,EAAAC,KAAA,CACA,GAAAW,OACA,MAGA,IAAAa,GAAAzB,EAAA0B,eAAA,GAAAP,QAAAD,OACAS,EAAA3B,EAAA0B,eAAA,GAAAL,QAAAD,MAEA,IAAAQ,UAAAA,WAAAH,EAAAA,EAAAE,EAAAA,EAEA,MAIA,aADAf,QAAA,GAIA,GAAA,YAAAZ,EAAAC,KAAA,CAQA,GANAD,EAAA6B,iBAEArB,SAAAsB,oBAAA,YAAA/B,mBAAA,GACAS,SAAAsB,oBAAA,WAAA/B,mBAAA,GACAS,SAAAsB,oBAAA,cAAA/B,mBAAA,GAEAa,OACA,MAGA,IAAAX,GAAAa,KAAAC,MAAAF,QAAAkB,UAAA,OAAA,QACAC,EAAAhC,EAAA0B,eAAA,GACAtB,EAAAJ,EAAAI,OACA6B,EAAAzB,SAAA0B,YAAA,aASA,OAPAD,GAAAE,eACAlC,GAAA,GAAA,EAAAD,EAAAoC,KAAApC,EAAAqC,OACAL,EAAAM,QAAAN,EAAAO,QAAAP,EAAAb,QAAAa,EAAAX,SACA,GAAA,GAAA,GAAA,EACA,EAAA,UAEAjB,GAAAoC,cAAAP,GAIA,MAAA,eAAAjC,EAAAC,MACAO,SAAAsB,oBAAA,YAAA/B,mBAAA,GACAS,SAAAsB,oBAAA,WAAA/B,mBAAA,OACAS,UAAAsB,oBAAA,cAAA/B,mBAAA,IAHA,OA1GAS,SAAAiC,gBAAAhC,UAAAC,SAAA,uBACAF,SAAAc,iBAAA,YAAA,SAAAtB,GAEAA,EAAA6B,kBAOA,IAAAX,QAAA,EACAE,OAAA,EACAP,OAAA,EACAG,OAAA,EACAJ,QAAA,EACAgB,UAAA,EACAG,UAAA,GAmGAvB,UAAAc,iBAAA,aAAAvB","file":"system.js","sourcesContent":["/// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n/// @Copyright ~2015 Samlv9 and other contributors.\r\n/// @MIT-LICENSE | dev-1.0.0 | http://samlv9.com/\r\n/// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n///                                              }|\r\n///                                              }|\r\n///                                              }|     　 へ　　　 ／|    \r\n///      _______     _______         ______      }|      /　│　　 ／ ／\r\n///     /  ___  |   |_   __ \\      .' ____ '.    }|     │　Z ＿,＜　／　　 /`ヽ\r\n///    |  (__ \\_|     | |__) |     | (____) |    }|     │　　　　　ヽ　　 /　　〉\r\n///     '.___`-.      |  __ /      '_.____. |    }|      Y　　　　　`　 /　　/\r\n///    |`\\____) |    _| |  \\ \\_    | \\____| |    }|    ｲ●　､　●　　⊂⊃〈　　/\r\n///    |_______.'   |____| |___|    \\______,'    }|    ()　 v　　　　|　＼〈\r\n///    |=========================================\\|    　>ｰ ､_　 ィ　 │ ／／\r\n///    | LESS IS MORE!                           ||     / へ　　 /　ﾉ＜|＼＼\r\n///    `=========================================/|    ヽ_ﾉ　　(_／　 │／／\r\n///                                              }|     7　　　　　　  |／\r\n///                                              }|     ＞―r￣￣`ｰ―＿`\r\n///                                              }|\r\n///                                              }|\r\n/// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n/// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n/// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n/// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n/// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n/// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n/// THE SOFTWARE.\r\n\r\n\r\n/// TODU:\r\n/// 这里在 `document` 上取消 `touchmove` 默认行为，防止浏览器出现弹性滚动条。\r\nif ( !document.documentElement.classList.contains(\"allow-native-touch\") ) {\r\n    document.addEventListener(\"touchmove\", function disableMovement( evt ) {\r\n        /// 启用自定义的滚动行为。\r\n        evt.preventDefault();\r\n    });\r\n}\r\n\r\n\r\n/// TODU:\r\n/// 这里禁用 `click` 事件的 300ms 延时；\r\nvar startX = 0;\r\nvar startY = 0;\r\nvar startT = 0;\r\nvar identy = 0;\r\nvar isMove = false;\r\nvar threshold = 5;\r\nvar holdDelay = 1000;\r\n\r\n\r\nfunction doTapClickHandler( evt ) {\r\n    if ( evt.type == \"touchstart\" ) {\r\n        if ( evt.targetTouches.length >= 2 ) {\r\n            return;\r\n        }\r\n\r\n        var target = evt.target;\r\n        var nodeName = target.nodeName.toLowerCase();\r\n        var nodeType = target.nodeType;\r\n\r\n        if ( (nodeType == 1) && (nodeName == \"input\" || nodeName == \"textarea\") ) {\r\n            /// 忽略 Input/Textarea；\r\n            return;\r\n        }\r\n\r\n        while( target && target != document ) {\r\n            if ( target.classList.contains(\".not-click\") ) {\r\n                /// 常规的 click 对象；\r\n                return;\r\n            }\r\n\r\n            target = target.parentNode;\r\n        }\r\n\r\n        isMove = false;\r\n        startT = Date.now();\r\n        identy = evt.targetTouches[0].identifier;\r\n        startX = evt.targetTouches[0].clientX;\r\n        startY = evt.targetTouches[0].clientY;\r\n        \r\n        document.addEventListener(\"touchmove\", doTapClickHandler, true);\r\n        document.addEventListener(\"touchend\" , doTapClickHandler, true);\r\n        document.addEventListener(\"touchcancel\", doTapClickHandler, true);\r\n\r\n        \r\n\r\n        /// 隐藏焦点状态；\r\n        if ( document.activeElement ) {\r\n            document.activeElement.blur();\r\n        }\r\n        return;\r\n    }\r\n\r\n    if ( evt.type == \"touchmove\" ) {\r\n        if ( isMove ) {\r\n            return;\r\n        }\r\n\r\n        var distX = evt.changedTouches[0].clientX - startX;\r\n        var distY = evt.changedTouches[0].clientY - startY;\r\n\r\n        if ( (distX * distX + distY * distY) <= (threshold * threshold) ) {\r\n            /// 移动距离小于阀值；\r\n            return;\r\n        }\r\n\r\n        isMove = true;\r\n        return;\r\n    }\r\n\r\n    if ( evt.type == \"touchend\" ) {\r\n        /// 禁用默认的 click 事件调度；\r\n        evt.preventDefault();\r\n\r\n        document.removeEventListener(\"touchmove\", doTapClickHandler, true);\r\n        document.removeEventListener(\"touchend\" , doTapClickHandler, true);\r\n        document.removeEventListener(\"touchcancel\", doTapClickHandler, true);\r\n\r\n        if ( isMove ) {\r\n            return;\r\n        }\r\n\r\n        var type   = ((Date.now() - startT) >= holdDelay) ? \"hold\" : \"click\";\r\n        var touch  = evt.changedTouches[0];\r\n        var target = evt.target;\r\n        var event  = document.createEvent(\"MouseEvent\");\r\n\r\n        event.initMouseEvent(\r\n            type, true, true, evt.view, evt.detail, \r\n            touch.screenX, touch.screenY, touch.clientX, touch.clientY, \r\n            false, false, false, false, \r\n            0, null);\r\n        \r\n\t\ttarget.dispatchEvent(event);\r\n        return;\r\n    }\r\n\r\n    if ( evt.type == \"touchcancel\" ) {\r\n        document.removeEventListener(\"touchmove\", doTapClickHandler, true);\r\n        document.removeEventListener(\"touchend\" , doTapClickHandler, true);\r\n        document.removeEventListener(\"touchcancel\", doTapClickHandler, true);\r\n        return;\r\n    }\r\n}\r\n\r\n\r\ndocument.addEventListener(\"touchstart\", doTapClickHandler);\r\n\r\n\r\n"],"sourceRoot":"/source/"}